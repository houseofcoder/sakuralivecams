<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SakuraLive - Japan Live Cams</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    .thumbnail {
      width: 100%;
      height: auto;
    }

    .card {
      margin-bottom: 20px;
      box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.1);
    }
    .video-card-title {
      font-size: 0.9rem;
      font-weight: bold;
    }
    .watch-btn{
      font-size: 0.9rem;
      font-weight: bold;
    }
    .card-img-top{
      width: 100%;
      max-height: 250px;
    }

    .video-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1050;
      padding: 20px;
    }

    .video-overlay iframe {
      width: 100%;
      height: 100%;
      max-height: 90%;
      max-width: 90%;
      border: none;
    }

    .close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background-color: #dc3545;
      color: #fff;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      z-index: 1100;
    }
    /* Highlight Location Section */
    #locationSection {
      background-color: #070808; /* Light gray background */
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow */
      transition: transform 0.2s, box-shadow 0.2s; /* Add hover effect */
    }

    #locationSection .location-title {
      font-size: 1.1rem; /* Larger font size for the title */
      font-weight: bold;
      color: #434548; /* Primary color */
      color: #fff;
    }

    #locationSection select {
      font-size: 1rem; /* Larger font for select options */
      padding: 0.75rem; /* Add spacing */
      
    }
    .featured-section{
      background: #070808;
    }

    /* Section Ribbon */
    .section-ribbon {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      background: #ff5733; /* Vibrant background color */
      color: white;
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      padding: 10px 0;
      z-index: 10;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-transform: uppercase;
    }

    /* Video Labels */
    .video-label {
      display: block;
      font-size: 18px;
      font-weight: bold;
      color: white;
      background-color: #2f2d2d; /* Bootstrap primary color */
      text-align: center;
      padding: 10px;
      margin-bottom: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>

  <div class="container mt-4">
    <!-- Header -->
    <header class="text-center mb-4">
      <h1>SakuraLive</h1>
      <p>Explore live streams from across Japan!</p>
    </header>

    <!-- Featured Section -->
    <div id="featuredSection" class="row featured-section mx-0 my-2  position-relative">
      <!-- Ribbon Label for the Section -->
      <div class="section-ribbon mb-6">Featured Streams</div>

      <!-- First Video Section -->
      <div class="col-md-6 mt-5">
        <iframe id="featuredVideo1" src="https://www.youtube.com/embed/TUd7JORZeWo?autoplay=1&mute=1" frameborder="0"
          allowfullscreen style="width: 100%; height: 300px;">
        </iframe>
        <label for="featuredVideo1" class="video-label">Shibuya Scramble Crossing</label>
      </div>
    
      <!-- Second Video Section -->
      <div class="col-md-6 mt-5 d-none d-md-block">
        
        <iframe id="featuredVideo2" src="https://www.youtube.com/embed/8e761gp0jgY?autoplay=1&mute=1" frameborder="0"
          allowfullscreen style="width: 100%; height: 300px;">
        </iframe>
        <label for="featuredVideo2" class="video-label">Ebisu, Shibuya</label>
      </div>
    </div>

    <!-- Filter -->
    <div id="locationSection" class="container mb-4">
      <div class="row justify-content-center">
        <div class="col-md-12 p-0">
          <div class="location-container text-center p-3">
            <h5 class="location-title mb-3">Select Location</h5>
            <select id="locationPicker" class="form-select form-select-lg">
              <option selected value="Tokyo">Tokyo</option>
              <!-- Dynamic options will be added here -->
            </select>
          </div>
        </div>
      </div>
      <!-- Videos Section -->
      <div id="videoList" class="row">
        <!-- Dynamic video cards will be inserted here -->
      </div>
    </div>

  </div>

  <!-- Video Player Overlay -->
  <div id="videoOverlay" class="video-overlay d-none">
    <iframe id="youtubeIframe" src="" allowfullscreen></iframe>
    <button class="close-btn" id="closePlayerBtn">Close</button>
  </div>

  <script>
    $(document).ready(function () {
      const videoDataUrl = 'https://luckydraw.lol/japan-live-cams/output2.json';
      const weatherApiUrl = 'https://api.open-meteo.com/v1/forecast?latitude=35.6895&longitude=139.6917&current_weather=true';
      const timeApiUrl = 'https://worldtimeapi.org/api/timezone/Asia/Tokyo';
      let videoData = [];
      let selectedLocation = 'Tokyo';

      // Fetch weather and time data
      function fetchWeatherAndTime() {
        // Fetch Tokyo temperature
        $.getJSON(weatherApiUrl, function (data) {
          const temp = data.current_weather.temperature;
          $('#currentTemp').text(`Temperature: ${temp}Â°C`);
        });

        // Fetch Tokyo time
        $.getJSON(timeApiUrl, function (data) {
          const time = new Date(data.datetime).toLocaleTimeString();
          $('#currentTime').text(`Time: ${time}`);
        });
      }

      // Fetch video data
      function fetchVideos() {
        $.ajax({
          url: videoDataUrl,
          method: 'GET',
          dataType: 'json',
          success: function (data) {
            videoData = data;
            populateLocations();
            filterVideos(selectedLocation);
          },
          error: function (error) {
            console.error('Error fetching video data:', error);
            alert('Failed to load video data. Please try again later.');
          }
        });
      }

      // Populate location dropdown
      function populateLocations() {
        const uniqueLocations = [...new Set(videoData.map(video => video.Location))];
        const locationPicker = $('#locationPicker');
        locationPicker.empty(); // Clear existing options
        uniqueLocations.forEach(location => {
          locationPicker.append(`<option value="${location}">${location}</option>`);
        });
      }

      // Filter videos by location
      function filterVideos(location) {
        if (location !== 'Tokyo') {
          $('#featuredSection').addClass('d-none'); // Hide featured section
          $('#featuredVideo').attr('src', '');
        } else {
          // $('#featuredSection').removeClass('d-none'); // Show featured section
        }

        const filteredVideos = videoData.filter(video => video.Location === location);
        const videoList = $('#videoList');
        videoList.empty(); // Clear existing video cards
        filteredVideos.forEach(video => {
          const videoId = video.Link.split('/').pop();
          const thumbnail = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;

          const card = `
          <div class="col-md-4 col-sm-6 col-12">
            <div class="card border-0">
              <img src="${thumbnail}" class="card-img-top thumbnail" alt="${video.Description}">
              <div class="card-body">
                <h5 class="card-title video-card-title">${video.Description}</h5>
                <button class="btn btn-danger w-100 watch-btn" data-link="${video.Link}">Watch Stream</button>
              </div>
            </div>
          </div>`;
          videoList.append(card);
        });
      }

      // Play video in full-page overlay
      function playVideo(link) {
        const videoId = link.split('/').pop();
        $('#youtubeIframe').attr('src', `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1`);
        $('#videoOverlay').removeClass('d-none');
      }

      // Close video overlay
      function closeVideoOverlay() {
        $('#youtubeIframe').attr('src', '');
        $('#videoOverlay').addClass('d-none');
      }

      // Event listener for location picker
      $('#locationPicker').on('change', function () {
        selectedLocation = $(this).val();
        filterVideos(selectedLocation);
      });

      // Event listener for watch buttons
      $(document).on('click', '.watch-btn', function () {
        const link = $(this).data('link');
        playVideo(link);
      });

      // Event listener for close button
      $('#closePlayerBtn').on('click', closeVideoOverlay);

      // Initialize app
      fetchWeatherAndTime();
      fetchVideos();
    });
  </script>

</body>

</html>